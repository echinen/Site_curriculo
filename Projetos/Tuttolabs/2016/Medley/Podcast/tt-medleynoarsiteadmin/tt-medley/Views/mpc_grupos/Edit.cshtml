@model tt_medley.Models.mpc_grupos

@{
    ViewBag.Title = "Edit";
}

<h2>Editar</h2>

@using (Html.BeginForm(null, null, FormMethod.Post, new { id = "createForm" }))
{
    @Html.AntiForgeryToken()
    
    <div class="form-horizontal">
        <hr />
        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
        @Html.HiddenFor(model => model.id)
        
        <div class="left-board">
                <div class="form-group">
                    <p class="control-label col-md-2">Nome</p>
                    <div class="col-md-10">
                        @Html.EditorFor(model => model.nome, new { htmlAttributes = new { @class = "form-control" } })
                        @Html.ValidationMessageFor(model => model.nome, "", new { @class = "text-danger" })
                    </div>
                </div>

                <div class="form-group">
                    <p class="control-label col-md-2">Descricao</p>
                    <div class="col-md-10">
                        @Html.EditorFor(model => model.descricao, new { htmlAttributes = new { @class = "form-control" } })
                        @Html.ValidationMessageFor(model => model.descricao, "", new { @class = "text-danger" })
                    </div>
                </div>
           </div>
            
        </div>
}

<div class="right-board">
    @{int checkedId = 0;}
    <div id="treeDemo">
        <ul>
            @foreach (var mpc_item in ViewBag.treeView.ChildNode)
            {
                <li>
                    @mpc_item.ItemName
                    <ul>
                        @foreach (var mpc_item_subitem in mpc_item.ChildNode)
                {
                    if (checkedId < ViewBag.grupos_is.Count)
                    {
                        if (ViewBag.grupos_is[checkedId].empresa_id == mpc_item_subitem.ItemId)
                        {
                                    <li><a href="#" class="jstree-clicked">@mpc_item_subitem.ItemName</a></li>
                                    checkedId++;
                                }
                                else if (ViewBag.grupos_is[checkedId].cargo_id == mpc_item_subitem.ItemId)
                                {
                                    <li><a href="#" class="jstree-clicked">@mpc_item_subitem.ItemName</a></li>
                                    checkedId++;
                                }
                                else if (ViewBag.grupos_is[checkedId].unidade_id == mpc_item_subitem.ItemId)
                                {
                                    <li><a href="#" class="jstree-clicked">@mpc_item_subitem.ItemName</a></li>
                                    checkedId++;
                                }
                                else if (ViewBag.grupos_is[checkedId].equipe_id == mpc_item_subitem.ItemId)
                                {
                                    <li><a href="#" class="jstree-clicked">@mpc_item_subitem.ItemName</a></li>
                                    checkedId++;
                                }
                                else if (ViewBag.grupos_is[checkedId].gestor_id == mpc_item_subitem.ItemId)
                                {
                                    <li><a href="#" class="jstree-clicked">@mpc_item_subitem.ItemName</a></li>
                                    checkedId++;
                                }
                                else
                                {
                                    <li><a href="#">@mpc_item_subitem.ItemName</a></li>

                                }
                            }
                            else
                            {
                                <li><a href="#">@mpc_item_subitem.ItemName</a></li>
                            }
                        }
                    </ul>
                </li>
            }
        </ul>
    </div>

    <div style='font-family:Arial'>
        <p class="infoText">
            @Html.TextBox("SearchString", ViewBag.CurrentFilter as string, new { @placeholder = "Nome do usuário" })
            <button id="searchUser" value="Buscar">Buscar</button>
        </p><br />
        <div id="userTree">
            <ul>
                @foreach (var user in ViewBag.usuarios)
                {
                    <li id="@user.id"><a href="#" class="jstree-clicked">@user.nome</a></li>
                }
            </ul>
        </div>
    </div>
</div>

<div class="form-group">
    <div class="col-md-offset-2 col-md-10">
        <input type="submit" value="Salvar" class="btn btn-primary" />
    </div>
</div>

<a href="@Url.Action("Index", "mpc_grupos", null)" title="Voltar para a Lista de Grupos" class="btn btn-info">
    <span class="glyphicon glyphicon-arrow-left" aria-hidden="true"></span>
    Voltar
</a>

    @section Style {
        <link href="@Url.Content("~/Content/jstree.min.css")" rel="stylesheet" type="text/css" />
    }

    @section Scripts {
        @Scripts.Render("~/bundles/jqueryval")
        <script src="@Url.Content("~/Scripts/jstree.min.js")" type="text/javascript"></script>
        <script src="@Url.Content("~/Scripts/jquery_tree_functions.js")" type="text/javascript"></script>
    }

    <style>
        .left-board {
            display: inline-block;
            float: left;
            width: 387px;
        }

        .right-board {
            display: inline-block;
            width: 300px;
        }

        .form-horizontal {
            width: 700px;
            margin: auto;
        }
    </style>
